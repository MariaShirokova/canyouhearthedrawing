(this["webpackJsonphear-draw-ts"]=this["webpackJsonphear-draw-ts"]||[]).push([[0],{101:function(e,n,t){"use strict";t(93);var o=t(95);t.d(n,"default",(function(){return o.a}))},123:function(e,n,t){e.exports=t(152)},128:function(e,n){},130:function(e,n){},151:function(e,n,t){},152:function(e,n,t){"use strict";t.r(n);var o,r,a=t(0),i=t.n(a),c=t(32),u=t.n(c),l=t(9),s=t(6),d=t(39),f=t(7),h=t(15),p=t(23),v=t.n(p);!function(e){e.linear="linear",e.radial="radial"}(o||(o={})),function(e){e[e.ellipse=0]="ellipse",e[e.rectangle=1]="rectangle",e[e.polygon=2]="polygon",e[e.blob=3]="blob"}(r||(r={}));var b=function(e,n){var t=Object(a.useRef)(e);t.current=e;var o=Object(a.useRef)(n);o.current=n,Object(a.useEffect)((function(){var e=function(e){var n=t.current,r=o.current;e.ctrlKey&&("KeyC"===e.code?n():"KeyV"===e.code&&r())};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[])},m=t(17),g=t(18),y=t(46),O=t(57),x=t(25),j=t(58),w=function(e){return function(e){return!!e.offsetX}(e)?{x:e.offsetX,y:e.offsetY}:{x:e.touches[0].clientX,y:e.touches[0].clientY}},C=["left","diagonal-rt-lb","diagonal-rb-lt"],E=["top","diagonal-lb-rt","diagonal-rb-lt"],_=["left","right","diagonal-lt-rb","diagonal-rb-lt","diagonal-lb-rt","diagonal-rt-lb"],k=["down","top","diagonal-lt-rb","diagonal-rb-lt","diagonal-lb-rt","diagonal-rt-lb"],S={down:"ns-resize",top:"ns-resize",left:"ew-resize",right:"ew-resize","diagonal-lb-rt":"nesw-resize","diagonal-rb-lt":"nwse-resize","diagonal-lt-rb":"nwse-resize","diagonal-rt-lb":"nesw-resize"},M={right:{down:"diagonal-lt-rb",top:"diagonal-lb-rt"},left:{down:"diagonal-rt-lb",top:"diagonal-rb-lt"}},R=function(){function e(n,t){var o=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15;Object(m.a)(this,e),this.paperScope=n,this.expandSize=r,this.onResize=null,this._resizeHoverRectangle=void 0,this._resizeVisibleRectangle=void 0,this._cursorBeforeModify=null,this._isShow=!1,this._onDocumentMouseUp=null,this._onDocumentMouseMove=null,this._onDocumentTouchMove=null,this.unbindMouseHoverHandlers=function(){o._resizeHoverRectangle.onMouseMove=null,o._resizeHoverRectangle.onMouseLeave=null},this.bindMouseHoverHandlers=function(){o._resizeHoverRectangle.onMouseMove=function(e){o.handleMouseMove(e)},o._resizeHoverRectangle.onMouseLeave=function(){o.handleBlur()}},this.handleMouseDown=function(e){o.unbindMouseHoverHandlers();var n=function(){return o.handleMouseUp()};window.addEventListener("mouseup",n),window.addEventListener("touchend",n),o._onDocumentMouseUp=n;var t=o.resizeHandlerCreator(e),r=o.resizeTouchHandlerCreator(e);window.addEventListener("mousemove",t),window.addEventListener("touchmove",r),o._onDocumentMouseMove=t,o._onDocumentTouchMove=r},this.handleMouseUp=function(){o._onDocumentMouseUp&&(window.removeEventListener("mouseup",o._onDocumentMouseUp),window.removeEventListener("touchend",o._onDocumentMouseUp)),o._onDocumentMouseMove&&(window.removeEventListener("mousemove",o._onDocumentMouseMove),window.removeEventListener("touchmove",o._onDocumentTouchMove)),o.bindMouseHoverHandlers()},this.handleMouseMove=function(e){var n=o.calculateDirection(e),t=S[n];null===o._cursorBeforeModify&&(o._cursorBeforeModify=document.body.style.cursor),document.body.style.cursor=t},this.handleBlur=function(){null!=o._cursorBeforeModify&&(document.body.style.cursor=o._cursorBeforeModify,o._cursorBeforeModify=null)},this.calculateDirection=function(e){var n=o._resizeHoverRectangle.bounds,t=n.height,r=n.width,a=n.x,i=n.y,c=(r+10)/100,u=(t+10)/100,l=20/c,s=20/u,d=(100-2*l)/2,f=(100-2*l)/2,h=(e.point.x-a)/c,p=(e.point.y-i)/u,v=h-50,b=p-50;return Math.abs(v)>=d&&Math.abs(b)>=f?M[v>0?"right":"left"][b>0?"down":"top"]:h<s?"left":h>100-s?"right":p<l?"top":"down"};var a=this.self.expandRectangle(t,this.expandSize),i=new this.paperScope.Color(0,0,0,.2);this._resizeVisibleRectangle=new this.paperScope.Path.Rectangle(a),this._resizeVisibleRectangle.strokeColor=i,this._resizeVisibleRectangle.strokeWidth=2,this._resizeVisibleRectangle.visible=!1;var c=this.self.expandRectangle(t,this.expandSize),u=new this.paperScope.Color(0,0,0,Number.EPSILON);this._resizeHoverRectangle=new this.paperScope.Path.Rectangle(c),this._resizeHoverRectangle.strokeColor=u,this._resizeHoverRectangle.strokeWidth=20,this._resizeHoverRectangle.visible=!1,this.bindMouseHoverHandlers(),this._resizeHoverRectangle.onMouseDown=function(e){o.handleMouseDown(e)}}return Object(g.a)(e,[{key:"updateSize",value:function(e){var n=this.self.expandRectangle(e,this.expandSize);this._resizeVisibleRectangle.bounds=n.clone(),this._resizeHoverRectangle.bounds=n}},{key:"shift",value:function(e,n){this._resizeHoverRectangle.position.x+=e,this._resizeHoverRectangle.position.y+=n,this._resizeVisibleRectangle.position.x+=e,this._resizeVisibleRectangle.position.y+=n}},{key:"bringToFront",value:function(){this._resizeVisibleRectangle.bringToFront(),this._resizeHoverRectangle.bringToFront()}},{key:"remove",value:function(){this._resizeVisibleRectangle.remove(),this._resizeHoverRectangle.remove()}},{key:"resizeHandlerCreator",value:function(e){var n=this,t=this.calculateDirection(e),o=C.includes(t),r=E.includes(t),a=this._resizeHoverRectangle.bounds.clone(),i=e.point;return function(e){var c=i.x,u=i.y,l=e.offsetX,s=e.offsetY,d=_.includes(t)?l-c:0,f=k.includes(t)?s-u:0;d=o?-d:d,f=r?-f:f;var h=a.clone(),p=h.width+d,v=h.height+f;if(p>10?(h.width=p,h.x+=o?-d:0):(h.width=n._resizeHoverRectangle.bounds.width,h.x=n._resizeHoverRectangle.bounds.x),v>10?(h.height=v,h.y+=r?-f:0):(h.height=n._resizeHoverRectangle.bounds.height,h.y=n._resizeHoverRectangle.bounds.y),n._resizeVisibleRectangle.bounds=h.clone(),n._resizeHoverRectangle.bounds=h,n.onResize){var b=n.self.unExpandRectangle(h,n.expandSize),m={width:b.width,height:b.height},g={x:b.x,y:b.y};n.onResize(m,g)}}}},{key:"resizeTouchHandlerCreator",value:function(e){var n=this,t=this.calculateDirection(e),o=C.includes(t),r=E.includes(t),a=this._resizeHoverRectangle.bounds.clone(),i=e.point;return function(e){if(e.touches[0]){var c=i.x,u=i.y,l=e.touches[0],s=l.clientX,d=l.clientY,f=_.includes(t)?s-c:0,h=k.includes(t)?d-u:0;f=o?-f:f,h=r?-h:h;var p=a.clone(),v=p.width+f,b=p.height+h;if(v>10?(p.width=v,p.x+=o?-f:0):(p.width=n._resizeHoverRectangle.bounds.width,p.x=n._resizeHoverRectangle.bounds.x),b>10?(p.height=b,p.y+=r?-h:0):(p.height=n._resizeHoverRectangle.bounds.height,p.y=n._resizeHoverRectangle.bounds.y),n._resizeVisibleRectangle.bounds=p.clone(),n._resizeHoverRectangle.bounds=p,n.onResize){var m=n.self.unExpandRectangle(p,n.expandSize),g={width:m.width,height:m.height},y={x:m.x,y:m.y};n.onResize(g,y)}}}}},{key:"isShow",get:function(){return this._isShow},set:function(e){this._isShow!==e&&(this._resizeVisibleRectangle.visible=e,this._resizeHoverRectangle.visible=e,this._isShow=e)}},{key:"self",get:function(){return e}}],[{key:"expandRectangle",value:function(e,n){var t=e.clone();return t.x-=n,t.y-=n,t.width+=2*n,t.height+=2*n,t}},{key:"unExpandRectangle",value:function(e,n){var t=e.clone();return t.x+=n,t.y+=n,t.width-=2*n,t.height-=2*n,t}}]),e}();var z=function(){var e={};return{on:function(n,t){e[n]=(e[n]||[]).concat(t)},off:function(n,t){e[n]=(e[n]||[]).filter((function(e){return e!==t}))},emit:function(n,t){(e[n]||[]).forEach((function(e){e(t)}))}}},F={segments:!0,stroke:!0,fill:!0,tolerance:5},P=function(){function e(n,t){var o=this;Object(m.a)(this,e),this._paperScope=n,this._shapeData=t,this._coreFigure=void 0,this.isDisable=!1,this._isPlayMode=!1,this._isActive=!1,this._ResizeArea=null,this._lastMovePosition=null,this._moveFigureHandler=null,this._touchFigureHandler=null,this._moveSegmentHandler=null,this._touchSegmentHandler=null,this._isScalable=!1,this.onClick=null,this._updateNotify=Object(y.throttle)((function(){if(!o.isPlayMode){var e=o.serializationToShapeData(o._coreFigure,o._shapeData);o._shapeData=e,o.static.emitter.emit("edited",e)}}),20),this._coreFigure=this.initCoreFigure(n,t),this.bindHandlers()}return Object(g.a)(e,[{key:"updateFromShapeData",value:function(e){var n;this.updateCoreFigureByShapeData(this._coreFigure,e,this._paperScope),this._shapeData=e,null===(n=this._ResizeArea)||void 0===n||n.updateSize(this._coreFigure.bounds)}},{key:"bringToFront",value:function(){var e;this._coreFigure.bringToFront(),null===(e=this._ResizeArea)||void 0===e||e.bringToFront()}},{key:"remove",value:function(){this._moveFigureHandler&&window.removeEventListener("mousemove",this._moveFigureHandler),this._touchFigureHandler&&window.removeEventListener("touchmove",this._touchFigureHandler),this._moveSegmentHandler&&window.removeEventListener("mousemove",this._moveSegmentHandler),this._touchSegmentHandler&&window.removeEventListener("touchmove",this._touchSegmentHandler),this._ResizeArea&&this._ResizeArea.remove(),this._coreFigure.remove()}},{key:"isSmoothFigure",value:function(){return!1}},{key:"isCanChangePoints",value:function(){return!1}},{key:"playTrack",value:function(){var e=this._shapeData.track;if(e){var n=e.SoundPaletteKey,t=e.soundPosition,o=new j.a(O.a),r=x.a[n].matrix,a=t.map((function(e){var n=e.x,t=e.y;return r[n][t].sound}));o.playSong(a)}}},{key:"bindHandlers",value:function(){var e=this;this._coreFigure.strokeColor=new this._paperScope.Color(0,0,0,Number.EPSILON),this._coreFigure.selectedColor=new this._paperScope.Color(0,1,0),this._coreFigure.strokeWidth=5,this.static.emitter.on("click",(function(n){n.id!==e.id&&(e.isActive=!1)})),this._paperScope.project.view.on("mouseup",(function(n){var t;if(!e.isDisable&&!e._isPlayMode){e.unbindSegmentMoveHandler();var o=n.modifiers.shift;if(e.isActive&&o){var r=e._paperScope.project.hitTest(n.point,F);r&&r.item===e._coreFigure&&"segment"===r.type&&(r.segment.remove(),null===(t=e._ResizeArea)||void 0===t||t.updateSize(e._coreFigure.bounds),n.stopPropagation())}}})),this._coreFigure.onMouseEnter=function(){e._isPlayMode&&(document.body.style.cursor="pointer")},this._coreFigure.onMouseLeave=function(){e._isPlayMode&&(document.body.style.cursor="initial")},this._coreFigure.onMouseUp=function(){e.unbindFigureMoveHandler()},this._coreFigure.onMouseDown=function(n){if(e._isPlayMode)return e.playTrack(),void(e._isScalable||(e._isScalable=!0,e._coreFigure.scale(1.1),setTimeout((function(){e._coreFigure.scale(1/1.1),e._isScalable=!1}),200)));if(e.isDisable)e.static.emitter.emit("click",e._shapeData);else{var t=!0;if(e.isActive){if(e.isCanChangePoints()){var o=e._paperScope.project.hitTest(n.point,F);if(o){var r,a=n.modifiers.shift;if(a&&"segment"===o.type)o.segment.remove(),null===(r=e._ResizeArea)||void 0===r||r.updateSize(e._coreFigure.bounds),n.stopPropagation(),t=!1,e._updateNotify();else if("segment"!==o.type||a){if("stroke"===o.type){var i,c=o.location.index+1,u=e._coreFigure.insert(c,n.point);e.isSmoothFigure()&&e._coreFigure.smooth(),null===(i=e._ResizeArea)||void 0===i||i.updateSize(e._coreFigure.bounds),e.bindSegmentMoveHandler(u),t=!1}}else e.bindSegmentMoveHandler(o.segment),t=!1}}}else e._paperScope.project.activeLayer.selected=!1,e.static.emitter.emit("click",e._shapeData),e.isActive=!0;if(t){var l=n.point,s=l.x,d=l.y;e.bindFigureMoveHandler({x:s,y:d})}e.onClick&&e.onClick()}}}},{key:"bindSegmentMoveHandler",value:function(e){var n=this;this._moveSegmentHandler=Object(y.throttle)((function(t){var o,r=w(t);e.point.x=r.x,e.point.y=r.y,null===(o=n._ResizeArea)||void 0===o||o.updateSize(n._coreFigure.bounds)}),20),this._touchSegmentHandler=Object(y.throttle)((function(t){var o,r=w(t);e.point.x=r.x,e.point.y=r.y,null===(o=n._ResizeArea)||void 0===o||o.updateSize(n._coreFigure.bounds)}),20),window.addEventListener("mousemove",this._moveSegmentHandler),window.addEventListener("touchmove",this._touchSegmentHandler)}},{key:"unbindSegmentMoveHandler",value:function(){this._moveSegmentHandler&&this._touchSegmentHandler&&(window.removeEventListener("mousemove",this._moveSegmentHandler),window.removeEventListener("touchmove",this._touchSegmentHandler),this._updateNotify(),this._moveSegmentHandler=null,this._touchSegmentHandler=null)}},{key:"bindFigureMoveHandler",value:function(e){var n=this;this._lastMovePosition=e,this._moveFigureHandler=Object(y.throttle)((function(e){return n.moveFigure(e)}),20),this._touchFigureHandler=Object(y.throttle)((function(e){return n.moveFigure(e)}),20),window.addEventListener("mousemove",this._moveFigureHandler),window.addEventListener("touchmove",this._touchFigureHandler)}},{key:"unbindFigureMoveHandler",value:function(){this._moveFigureHandler&&this._touchFigureHandler&&(window.removeEventListener("mousemove",this._moveFigureHandler),window.removeEventListener("touchmove",this._touchFigureHandler),this._updateNotify(),this._lastMovePosition=null)}},{key:"moveFigure",value:function(e){if(this._lastMovePosition){var n=w(e),t=n.x-this._lastMovePosition.x,o=n.y-this._lastMovePosition.y;this._coreFigure.position.x+=t,this._coreFigure.position.y+=o,this._ResizeArea&&this._ResizeArea.shift(t,o),this._lastMovePosition=n}}},{key:"resizeFigure",value:function(e,n){this._coreFigure.bounds.width=e.width,this._coreFigure.bounds.height=e.height,this._coreFigure.bounds.x=n.x,this._coreFigure.bounds.y=n.y}},{key:"shapeData",get:function(){return this._shapeData}},{key:"static",get:function(){return e}},{key:"bounds",get:function(){return this._coreFigure.bounds}},{key:"id",get:function(){return this._shapeData.id}},{key:"isPlayMode",get:function(){return this._isPlayMode},set:function(e){this._isPlayMode=e,this.isActive=!1}},{key:"isActive",get:function(){return this._isActive},set:function(e){var n=this;this._isActive!==e&&(this._ResizeArea||(this._ResizeArea=new R(this._paperScope,this._coreFigure.bounds),this._ResizeArea.onResize=function(e,t){n.resizeFigure(e,t),n._updateNotify()}),this.isCanChangePoints()&&(this._coreFigure.selected=e),this._ResizeArea.isShow=e,this._isActive=e)}},{key:"isResizing",get:function(){return!!this._ResizeArea&&this._ResizeArea.isShow},set:function(e){var n=this;this._ResizeArea||(this._ResizeArea=new R(this._paperScope,this._coreFigure.bounds),this._ResizeArea.onResize=function(e,t){n.resizeFigure(e,t)}),this._ResizeArea.isShow=e}}]),e}();P.emitter=z();var H=t(31),D=t(30),L=function(e,n,t){switch(n){case"-":return{x:e.x-t.x,y:e.y-t.y};case"+":return{x:e.x+t.x,y:e.y+t.y};case"*":return{x:e.x*t.x,y:e.y*t.y};case"/":return{x:e.x/t.x,y:e.y/t.y}}},B=function(e,n){var t=Object(s.a)(e,2),o=t[0],r=t[1],a=Object(s.a)(n,2),i=a[0],c=a[1],u=L(r,"-",o),l=L(c,"-",i),d=-u.y,f=+u.x,h=-(d*o.x+f*o.y),p=-l.y,v=+l.x,b=-(p*i.x+v*i.y),m=p*o.x+v*o.y+b,g=p*r.x+v*r.y+b,y=d*i.x+f*i.y+h,O=d*c.x+f*c.y+h;if(m*g>=0||y*O>=0)return!1;var x=m/(m-g),j=L({x:x,y:x},"*",u);return L(o,"+",j)},A=function(e,n){if(!function(e){return!!e.type&&"rgb"!==e.type}(n))return new v.a.Color(n.red/255,n.green/255,n.blue/255,n.alpha);var t=e.bounds,o=t.width,r=t.height,a=t.x,i=t.y,c={stops:n.points.map((function(e){return new v.a.GradientStop(new v.a.Color(e.red/255,e.green/255,e.blue/255,e.alpha),e.left/100)})),radial:"linear"!==n.type};if("linear"===n.type){var u,l,s={x:a+Math.round(o/2),y:i+Math.round(r/2)},d=n.degree+90,f=function(e){var n=e/180*Math.PI;return{x:Math.cos(n),y:Math.sin(n)}}(d),h=2*Math.max(o,r),p={x:f.x*h,y:f.y*h},b=[{x:Math.floor(s.x-p.x),y:Math.floor(s.y-p.y)},{x:Math.ceil(s.x+p.x),y:Math.ceil(s.y+p.y)}],m=function(e){var n=e.width,t=e.height,o=e.x,r=e.y;return{top:[{x:o,y:r},{x:o+n,y:r}],bottom:[{x:o,y:r+t},{x:o+n,y:r+t}],left:[{x:o,y:r},{x:o,y:r+t}],right:[{x:o+n,y:r},{x:o+n,y:r+t}]}}(e.bounds),g=B(b,m.top),y=B(b,m.bottom),O=B(b,m.left),x=B(b,m.right);if(g){if(!y)return;if(u=g,l=y,d>360||d<180){var j=[l,u];u=j[0],l=j[1]}}else{if(!O||!x)return;if(u=O,l=x,!(d>90&&d<270)){var w=[l,u];u=w[0],l=w[1]}}return{gradient:c,origin:[Math.round(u.x),Math.round(u.y)],destination:[Math.round(l.x),Math.round(l.y)]}}return{gradient:c,destination:[a,i],origin:[a+Math.round(o/2),i+Math.round(r/2)]}},N=function(e){Object(H.a)(t,e);var n=Object(D.a)(t);function t(){return Object(m.a)(this,t),n.apply(this,arguments)}return Object(g.a)(t,[{key:"initCoreFigure",value:function(e,n){var t=n.color,o=n.shapeScheme,r=o.size,a=o.point,i=new e.Path.Ellipse({width:r.width,height:r.height,x:a.x,y:a.y});return i.fillColor=A(i,t),i}},{key:"updateCoreFigureByShapeData",value:function(e,n){var t=n.color,o=n.shapeScheme,r=o.size,a=o.point;e.bounds.height=r.height,e.bounds.width=r.width,e.bounds.x=a.x,e.bounds.y=a.y,e.fillColor=A(e,t)}},{key:"serializationToShapeData",value:function(e,n){return Object(l.a)(Object(l.a)({},n),{},{shapeScheme:{size:{width:e.bounds.width,height:e.bounds.height},point:{x:e.bounds.x,y:e.bounds.y}}})}}]),t}(P),T=function(e){Object(H.a)(t,e);var n=Object(D.a)(t);function t(){return Object(m.a)(this,t),n.apply(this,arguments)}return Object(g.a)(t,[{key:"initCoreFigure",value:function(e,n){var t=n.color,o=n.shapeScheme,r=o.size,a=o.point,i=new v.a.Path.Rectangle({width:r.width,height:r.height,x:a.x,y:a.y});return i.fillColor=A(i,t),i}},{key:"updateCoreFigureByShapeData",value:function(e,n){var t=n.color,o=n.shapeScheme,r=o.size,a=o.point;e.bounds.height=r.height,e.bounds.width=r.width,e.bounds.x=a.x,e.bounds.y=a.y,e.fillColor=A(e,t)}},{key:"serializationToShapeData",value:function(e,n){return Object(l.a)(Object(l.a)({},n),{},{shapeScheme:{size:{width:e.bounds.width,height:e.bounds.height},point:{x:e.bounds.x,y:e.bounds.y}}})}}]),t}(P),I=function(e){Object(H.a)(t,e);var n=Object(D.a)(t);function t(){return Object(m.a)(this,t),n.apply(this,arguments)}return Object(g.a)(t,[{key:"initCoreFigure",value:function(e,n){var t=n.color,o=n.shapeScheme.points,r=new e.Path;return r.closed=!0,o.forEach((function(n){var t=new e.Point(n);r.add(t)})),this.isSmoothFigure()&&r.smooth(),r.fillColor=A(r,t),r}},{key:"isCanChangePoints",value:function(){return!0}},{key:"updateCoreFigureByShapeData",value:function(e,n,t){var o=n.color,r=n.shapeScheme.points;e.removeSegments(),r.forEach((function(n){var o=new t.Point(n);e.add(o)})),this.isSmoothFigure()&&e.smooth(),e.fillColor=A(e,o)}},{key:"serializationToShapeData",value:function(e,n){return Object(l.a)(Object(l.a)({},n),{},{shapeScheme:{points:e.segments.map((function(e){return{x:e.point.x,y:e.point.y}}))}})}}]),t}(P),U=function(e){Object(H.a)(t,e);var n=Object(D.a)(t);function t(){return Object(m.a)(this,t),n.apply(this,arguments)}return Object(g.a)(t,[{key:"isSmoothFigure",value:function(){return!0}}]),t}(I),V=t(184),X=t(188),K=(t(90),t(73)),W=t.n(K),G=t(194),Z=t(189),Y=t(100);var J=function(e){var n=Object(a.useRef)();return Object(a.useEffect)((function(){n.current=e}),[e]),n.current},q={red:0,green:0,blue:255,alpha:1},Q={points:[{left:0,red:0,green:255,blue:0,alpha:1},{left:100,red:0,green:100,blue:255,alpha:1}],degree:0,type:o.linear},$=t(10),ee=t(11);function ne(){var e=Object($.a)(["\n  .ui-color-picker {\n    width: 100%;\n    margin: 0;\n    padding-top: 10px;\n    background-color: transparent;\n    .input-group {\n      display: none;\n    }\n  }\n"]);return ne=function(){return e},e}function te(){var e=Object($.a)(["\n  padding: 0 5px 5px;\n"]);return te=function(){return e},e}var oe=ee.a.div(te()),re=ee.a.div(ne()),ae=Object(a.memo)((function(e){var n=e.id,t=e.color,o=e.onChange,r=!!t&&!!t.points,c=Object(a.useState)({color:null!==t&&void 0!==t?t:q,pikerIsGradient:r}),u=Object(s.a)(c,2),d=u[0],f=d.color,h=d.pikerIsGradient,p=u[1],v=J(n);Object(a.useEffect)((function(){t&&p({color:null!==t&&void 0!==t?t:q,pikerIsGradient:r})}),[t,r,p]);var b=Object(a.useCallback)((function(e){var n=e?Q:q;o(n),p({pikerIsGradient:e,color:n})}),[p,o]),m=Object(a.useCallback)(W()((function(e){p((function(n){return Object(l.a)(Object(l.a)({},n),{},{color:e})})),o(e)}),20),[p,o]),g=Object(a.useMemo)(W()((function(){var e={};return f?(e[h?"gradient":"color"]=Object(l.a)({},f),e):e}),20),[f,h]);return v&&v!==n?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(oe,null,i.a.createElement(Z.a,{value:Number(h),fullWidth:!0,onChange:function(e){return b(!!e.target.value)}},i.a.createElement(G.a,{value:0},"Fill"),i.a.createElement(G.a,{value:1},"Gradient"))),i.a.createElement(re,null,i.a.createElement(Y.ColorPicker,Object.assign({onStartChange:m,onChange:m,onEndChange:m,isGradient:h},g))))})),ie=t(101);function ce(){var e=Object($.a)(["\n  position: absolute;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  width: 260px;\n  padding: 15px 10px;\n  border-left: 1px solid #c1c1c1;\n  box-shadow: 0 0 5px #00000075;\n  background: #fff;\n  &:after {\n    content: '';\n    display: block;\n    width: 260px;\n  }\n"]);return ce=function(){return e},e}var ue=ee.a.div(ce()),le=function(e){var n=e.selectShape,t=e.background,o=e.onColorChange,r=e.onTrackChange,a=n||{},c=a.color,u=a.track;return i.a.createElement(ue,null,i.a.createElement(X.a,{sx:{mb:5}},i.a.createElement(X.a,{sx:{mb:1}},i.a.createElement(V.a,null,"Color")),i.a.createElement(ae,{id:null===n||void 0===n?void 0:n.id,color:c||t,onChange:function(e){return o(e)}})),!!n&&i.a.createElement(X.a,null,i.a.createElement(X.a,{sx:{mb:1}},i.a.createElement(X.a,{sx:{mb:1}},i.a.createElement(V.a,null,"Sound"))),i.a.createElement(ie.default,{track:u||null,onTrackChange:function(e){return r(e)}})))},se=t(185),de=t(102),fe=t.n(de),he=t(61),pe=t(103),ve=t.n(pe);function be(){return(be=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}).apply(this,arguments)}function me(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var ge=i.a.createElement("path",{d:"M31.5 15.5C31.5 23.7694 24.5755 30.5 16 30.5C7.4245 30.5 0.5 23.7694 0.5 15.5C0.5 7.23057 7.4245 0.5 16 0.5C24.5755 0.5 31.5 7.23057 31.5 15.5Z",stroke:"black"}),ye=function(e){var n=e.svgRef,t=e.title,o=me(e,["svgRef","title"]);return i.a.createElement("svg",be({width:32,height:31,viewBox:"0 0 32 31",fill:"none",ref:n},o),t?i.a.createElement("title",null,t):null,ge)},Oe=i.a.forwardRef((function(e,n){return i.a.createElement(ye,be({svgRef:n},e))}));t.p;function xe(){return(xe=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}).apply(this,arguments)}function je(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var we=i.a.createElement("path",{d:"M26.3388 2L17.6612 14.4091L2.04132 4.48182L11.0661 20.7909L1 23.2727L12.4545 25.7545L8.63636 41L20.438 27.1727L33.6281 36.0364L25.2975 23.2727L43 14.4091L25.2975 15.4727L26.3388 2Z",stroke:"black"}),Ce=function(e){var n=e.svgRef,t=e.title,o=je(e,["svgRef","title"]);return i.a.createElement("svg",xe({width:44,height:42,viewBox:"0 0 44 42",fill:"none",ref:n},o),t?i.a.createElement("title",null,t):null,we)},Ee=i.a.forwardRef((function(e,n){return i.a.createElement(Ce,xe({svgRef:n},e))}));t.p;function _e(){return(_e=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}).apply(this,arguments)}function ke(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var Se=i.a.createElement("rect",{x:.5,y:.5,width:27,height:27,stroke:"black"}),Me=function(e){var n=e.svgRef,t=e.title,o=ke(e,["svgRef","title"]);return i.a.createElement("svg",_e({width:28,height:28,viewBox:"0 0 28 28",fill:"none",ref:n},o),t?i.a.createElement("title",null,t):null,Se)},Re=i.a.forwardRef((function(e,n){return i.a.createElement(Me,_e({svgRef:n},e))}));t.p;function ze(){return(ze=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}).apply(this,arguments)}function Fe(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var Pe=i.a.createElement("path",{d:"M15.1726 10.98C12.265 13.0386 11.376 11.0544 9.84031 7.24901C8.5856 4.13987 3.88061 5.07261 2.62603 6.31627C0.772506 8.15367 0.164671 13.8435 2.62603 17.1983C5.13532 20.6183 7.95832 17.8201 7.95832 21.862C7.95832 24.0384 -0.510648 28.3912 4.82167 34.9205C10.154 41.4497 14.2316 28.3912 18.6229 27.4585C23.0142 26.5257 15.8 43.1127 27.4056 38.0296C40.8932 32.1222 27.5388 27.1049 29.6012 24.0384C30.8559 22.1729 42.2149 26.1542 40.8932 19.9965C37.7565 5.38349 27.4056 14.0891 26.1509 14.0891C24.6539 14.0891 23.3279 11.1665 24.5826 8.18173C26.1509 4.45073 27.4056 1.65252 19.5639 1.03069C11.7223 0.408858 17.3683 9.42542 15.1726 10.98Z",stroke:"black"}),He=function(e){var n=e.svgRef,t=e.title,o=Fe(e,["svgRef","title"]);return i.a.createElement("svg",ze({width:42,height:40,viewBox:"0 0 42 40",fill:"none",ref:n},o),t?i.a.createElement("title",null,t):null,Pe)},De=i.a.forwardRef((function(e,n){return i.a.createElement(He,ze({svgRef:n},e))}));t.p;function Le(){return(Le=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}).apply(this,arguments)}function Be(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var Ae=i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.5 0.178574C19.7761 0.178574 20 0.402431 20 0.678574V31.0621L28.3737 21.4922C28.5556 21.2844 28.8714 21.2633 29.0793 21.4451C29.2871 21.627 29.3081 21.9429 29.1263 22.1507L19.8763 32.7221C19.7833 32.8284 19.6497 32.8904 19.5086 32.8928C19.3674 32.8952 19.2318 32.8378 19.1352 32.7348L9.22452 22.1634C9.03565 21.9619 9.04586 21.6455 9.24732 21.4567C9.44877 21.2678 9.76519 21.278 9.95405 21.4795L19 31.1285V0.678574C19 0.402431 19.2239 0.178574 19.5 0.178574ZM1 20C1.27614 20 1.5 20.2239 1.5 20.5V38.5H37.5V20.5C37.5 20.2239 37.7239 20 38 20C38.2761 20 38.5 20.2239 38.5 20.5V39.5H0.5V20.5C0.5 20.2239 0.723858 20 1 20Z",fill:"black"}),Ne=function(e){var n=e.svgRef,t=e.title,o=Be(e,["svgRef","title"]);return i.a.createElement("svg",Le({width:39,height:40,viewBox:"0 0 39 40",fill:"none",ref:n},o),t?i.a.createElement("title",null,t):null,Ae)},Te=i.a.forwardRef((function(e,n){return i.a.createElement(Ne,Le({svgRef:n},e))}));t.p;function Ie(){return(Ie=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}).apply(this,arguments)}function Ue(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var Ve=i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M22.8202 0.500654C29.3256 0.763624 32.8974 4.56303 34.8585 8.2487C35.8366 10.0869 36.4195 11.9033 36.777 13.2529C36.9398 13.8678 37.0566 14.3886 37.1414 14.767L37.1653 14.8739C37.1843 14.9584 37.2011 15.0321 37.216 15.0957C39.6763 15.1764 41.5715 16.0839 42.8878 17.443C44.2605 18.8604 44.9761 20.74 45.076 22.6064C45.1757 24.4709 44.6625 26.3562 43.533 27.7855C42.3941 29.2267 40.6485 30.1765 38.3619 30.1765H29.8246C29.5484 30.1765 29.3246 29.9526 29.3246 29.6765C29.3246 29.4003 29.5484 29.1765 29.8246 29.1765H38.3619C40.3441 29.1765 41.8001 28.3655 42.7484 27.1654C43.7062 25.9535 44.166 24.3171 44.0774 22.6599C43.9889 21.0046 43.3548 19.3626 42.1695 18.1387C40.9913 16.9222 39.2409 16.0898 36.8554 16.0898C36.6079 16.0898 36.4733 15.9219 36.4465 15.8877C36.4032 15.8324 36.3779 15.778 36.3657 15.7503C36.3391 15.6897 36.3185 15.6217 36.3029 15.5658C36.27 15.4478 36.2323 15.2828 36.1897 15.0932L36.1657 14.9863C36.0809 14.608 35.968 14.1044 35.8103 13.5089C35.464 12.2015 34.905 10.4648 33.9757 8.71844C32.1249 5.24 28.8273 1.74961 22.7941 1.50042C16.7608 1.74961 13.4633 5.24 11.6124 8.71844C10.6832 10.4648 10.1241 12.2015 9.77784 13.5089C9.62012 14.1044 9.50723 14.608 9.42242 14.9863L9.39843 15.0932C9.35582 15.2828 9.3181 15.4478 9.2852 15.5658C9.2696 15.6217 9.24905 15.6897 9.2224 15.7503C9.21027 15.778 9.18493 15.8324 9.14163 15.8877C9.11488 15.9219 8.98022 16.0898 8.73269 16.0898C6.34722 16.0898 4.59683 16.9222 3.41867 18.1387C2.23333 19.3626 1.59927 21.0046 1.51074 22.6599C1.42211 24.3171 1.88193 25.9535 2.8397 27.1654C3.78804 28.3655 5.24401 29.1765 7.22626 29.1765H15.7636C16.0397 29.1765 16.2636 29.4003 16.2636 29.6765C16.2636 29.9526 16.0397 30.1765 15.7636 30.1765H7.22626C4.93968 30.1765 3.19407 29.2267 2.05512 27.7855C0.92561 26.3562 0.412448 24.4709 0.512167 22.6064C0.611993 20.74 1.32762 18.8604 2.70034 17.443C4.01666 16.0839 5.91185 15.1764 8.37219 15.0957C8.38705 15.0321 8.40379 14.9584 8.42279 14.8739L8.44676 14.767L8.44677 14.767C8.53158 14.3886 8.64832 13.8677 8.81117 13.2529C9.16862 11.9033 9.7515 10.0869 10.7296 8.2487C12.6907 4.56303 16.2626 0.763624 22.768 0.500654C22.77 0.500572 22.772 0.50049 22.7741 0.500409C22.7808 0.500141 22.7874 0.500005 22.7941 0.5",fill:"black"}),Xe=i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M22.7942 40.5C22.518 40.5 22.2942 40.2761 22.2942 40L22.2942 17.2634L16.2914 24.2666C16.1117 24.4762 15.7961 24.5005 15.5864 24.3208C15.3767 24.1411 15.3525 23.8254 15.5322 23.6158L22.4145 15.5864C22.5095 15.4755 22.6482 15.4118 22.7942 15.4118C22.9401 15.4118 23.0788 15.4755 23.1738 15.5864L30.0561 23.6158C30.2358 23.8254 30.2116 24.1411 30.0019 24.3208C29.7922 24.5005 29.4766 24.4762 29.2969 24.2666L23.2942 17.2634L23.2942 40C23.2942 40.2761 23.0703 40.5 22.7942 40.5Z",fill:"black"}),Ke=function(e){var n=e.svgRef,t=e.title,o=Ue(e,["svgRef","title"]);return i.a.createElement("svg",Ie({width:46,height:41,viewBox:"0 0 46 41",fill:"none",ref:n},o),t?i.a.createElement("title",null,t):null,Ve,Xe)},We=i.a.forwardRef((function(e,n){return i.a.createElement(Ke,Ie({svgRef:n},e))}));t.p;function Ge(){return(Ge=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}).apply(this,arguments)}function Ze(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var Ye=i.a.createElement("defs",null,i.a.createElement("style",null,".cls-1{fill:none;stroke:#000;stroke-width:2px;}")),Je=i.a.createElement("polygon",{className:"cls-1",points:"12.34 9.08 12.34 39.03 38.07 24.06 12.34 9.08"}),qe=function(e){var n=e.svgRef,t=e.title,o=Ze(e,["svgRef","title"]);return i.a.createElement("svg",Ge({id:"Layer_1",viewBox:"0 0 48.11 48.11",ref:n},o),t?i.a.createElement("title",null,t):null,Ye,Je)},Qe=i.a.forwardRef((function(e,n){return i.a.createElement(qe,Ge({svgRef:n},e))}));t.p;function $e(){var e=Object($.a)(["\n  border-radius: 30px;\n  padding: "," 0px;\n  margin-bottom: ",";\n  display: flex;\n  flex-direction: column;\n  background: #eee;\n"]);return $e=function(){return e},e}function en(){var e=Object($.a)(["\n  top: 50%;\n  margin-top: -200px;\n  position: absolute;\n  left: 15px;\n  margin-bottom: -126px;\n"]);return en=function(){return e},e}function nn(){var e=Object($.a)([";\n  &.MuiIconButton-root {\n    position: absolute;\n    top: -65px;\n    background: #f44336;\n    color: #fff;\n    &:hover {\n      background: #d32f2f\n    }\n  }\n"]);return nn=function(){return e},e}function tn(){var e=Object($.a)(["\n  &.MuiIconButton-root {\n    background: transparent;\n    color: #fff;\n    svg {\n      fill: transparent;\n    }\n    &:active {\n      background: transparent;\n      svg {\n        fill: #000;\n      }\n    }\n  }\n"]);return tn=function(){return e},e}var on=Object(ee.a)(se.a)(tn()),rn=Object(ee.a)(se.a)(nn()),an=ee.a.div(en()),cn=ee.a.div($e(),(function(e){return e.withoutExtraPadding?"0px":"10px"}),(function(e){return e.hasButtonOffset?"10px":"0"})),un=function(e){var n=e.selectShape,t=e.isPlayMode,o=e.createFigure,a=e.removeFigure,c=e.openDownloadModal,u=e.openUploadModal,l=e.setPlayMode;return i.a.createElement(an,null,!!n&&i.a.createElement(rn,{onClick:function(){return a(n)}},i.a.createElement(fe.a,null)),i.a.createElement(cn,{hasButtonOffset:!0},i.a.createElement(on,{onClick:function(){return o(r.rectangle)}},i.a.createElement(he.a,{component:Re,viewBox:"0 0 28 28",style:{padding:"1px",boxSizing:"border-box"}})),i.a.createElement(on,{onClick:function(){return o(r.ellipse)}},i.a.createElement(he.a,{component:Oe,viewBox:"0 0 32 31"})),i.a.createElement(on,{onClick:function(){return o(r.blob)}},i.a.createElement(he.a,{component:De,viewBox:"0 0 42 40"})),i.a.createElement(on,{onClick:function(){return o(r.polygon)}},i.a.createElement(he.a,{component:Ee,viewBox:"0 0 44 42"}))),i.a.createElement(cn,{hasButtonOffset:!0},i.a.createElement(on,{onClick:function(){return c()}},i.a.createElement(he.a,{component:Te,viewBox:"0 0 42 40",style:{fill:"transparent",padding:"1px",boxSizing:"border-box"}})),i.a.createElement(on,{onClick:function(){return u()}},i.a.createElement(he.a,{component:We,viewBox:"0 0 46 41",style:{fill:"transparent"}}))),i.a.createElement(cn,{withoutExtraPadding:!0},i.a.createElement(se.a,{onClick:function(){return l(!t)}},!t&&i.a.createElement(he.a,{component:Qe,viewBox:"0 0 48.11 48.11"}),t&&i.a.createElement(ve.a,{style:{color:"#000"}}))))},ln=function(){return{alpha:1,red:Math.round(255*Math.random()),green:Math.round(255*Math.random()),blue:Math.round(255*Math.random())}},sn={x:150,y:150},dn={width:200,height:200},fn=x.a.default.key,hn=function(e){return[r.ellipse,r.rectangle].includes(e)},pn=function(e){var n=new e.Color(255,255,255,1),t=e.view.bounds,o={width:t.width,height:t.height};return new T(e,{id:"0000",type:r.rectangle,color:n,track:null,shapeScheme:{point:{x:0,y:0},size:o}})};function vn(){var e=Object($.a)(["\n  width: 100%;\n  height: 100%;\n"]);return vn=function(){return e},e}function bn(){var e=Object($.a)(["\n  display: flex;\n  flex-direction: row;\n  width: 100%;\n  height: 100%;\n"]);return bn=function(){return e},e}var mn=ee.a.div(bn());ee.a.div(vn());function gn(){var e=Object($.a)(["\n  width: 300px;\n  position: absolute;\n  top: 15px;\n  left: 15px;\n  input {\n    font-size: 20px;\n  }\n"]);return gn=function(){return e},e}var yn=ee.a.div(gn());function On(){var e=Object($.a)(["\n  //width: 800px;\n  //height: 800px;\n  //pointer-events: none\n"]);return On=function(){return e},e}var xn=ee.a.div(On()),jn=Object(a.memo)((function(e){var n=e.canvasRef;return i.a.createElement(xn,null,i.a.createElement("canvas",{ref:n}))})),wn=t(179);var Cn=function(e){var n=Object(a.useRef)(e);n.current=e,Object(a.useEffect)((function(){var e=function(e){"Delete"!==e.code&&"Backspace"!==e.code||(0,n.current)()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[])},En=function(e){var n=e.title,t=e.shapeList,o=e.backgroundColor,c=e.isPlayMode,u=e.updateShapeList,p=e.updateBackgroundColor,m=e.updateTitle,g=e.openUploadModal,y=e.openDownloadModal,O=e.setPlayMode,x=Object(a.useState)(null),j=Object(s.a)(x,2),w=j[0],C=j[1],E=Object(a.useRef)(null),_=Object(a.useRef)([]);_.current=t;var k=Object(a.useMemo)((function(){return t.find((function(e){return e.id===w}))||null}),[w,t]),S=Object(a.useRef)(null),M=Object(a.useRef)(null),R=Object(a.useRef)([]),z=Object(a.useRef)(null),F=Object(a.useRef)(),H=Object(a.useRef)(null),D=Object(a.useCallback)((function(e){var n=_.current,t=n.findIndex((function(n){return n.id===e.id}));-1!==t&&u([].concat(Object(f.a)(n.slice(0,t)),[e],Object(f.a)(n.slice(t+1))))}),[u]),L=Object(a.useCallback)((function(){var e=S.current,n=z.current,t=F.current;if(e&&n&&t){var o=e.clientWidth,r=e.clientHeight;t.view.viewSize.width=o,t.view.viewSize.height=r,n.updateFromShapeData(Object(l.a)(Object(l.a)({},n.shapeData),{},{shapeScheme:Object(l.a)(Object(l.a)({},n.shapeData.shapeScheme),{},{size:{width:o,height:r}})})),t.view.update()}}),[]);Object(a.useEffect)((function(){if(!M.current)throw new Error("Expected canvas element missing");var e=new v.a.PaperScope;e.setup(M.current),F.current=e;var n=pn(e);n.isDisable=!0,z.current=n;var t=null,o=function(e){var n=_.current,t=n.findIndex((function(n){return n.id===e.id}));-1!==t&&u([].concat(Object(f.a)(n.slice(0,t)),[e],Object(f.a)(n.slice(t+1))))},r=function(e){var n,o;if(e.id!==(null===(n=z.current)||void 0===n?void 0:n.id)){var r=_.current,a=r.findIndex((function(n){return n.id===e.id}));-1!==a&&(u([].concat(Object(f.a)(r.slice(0,a)),Object(f.a)(r.slice(a+1)),[e])),(null===(o=t)||void 0===o?void 0:o.id)!==e.id&&C(e.id))}else C(null)},a=function(){var e;null===(e=H.current)||void 0===e||e.focus()},i=S.current;return window.addEventListener("resize",L),null===i||void 0===i||i.addEventListener("click",a),P.emitter.on("click",r),P.emitter.on("edited",o),function(){window.removeEventListener("resize",L),null===i||void 0===i||i.removeEventListener("click",a),P.emitter.off("click",r),P.emitter.on("edited",o)}}),[C,u,L]),Object(a.useEffect)((function(){if(!F.current)throw new Error("Expected scope missing");var e=function(e){return e.reduce((function(e,n){return Object(l.a)(Object(l.a)({},e),{},Object(h.a)({},n.id,n))}),{})}(R.current),n=F.current;R.current=[],t.forEach((function(t){var o=e[t.id];o?(o.updateFromShapeData(t),delete e[t.id]):o=function(e,n){switch(n.type){case r.rectangle:return new T(e,n);case r.ellipse:return new N(e,n);case r.polygon:return new I(e,n);case r.blob:return new U(e,n)}}(n,t),R.current.push(o),o.bringToFront()})),Object.values(e).forEach((function(e){e.remove()}))}),[t]),Object(a.useEffect)((function(){if(k){var e=R.current.find((function(e){return e.id===k.id}));e&&(R.current.forEach((function(e){return e.isActive=!1})),e.isActive=!0)}}),[k]),Object(a.useEffect)((function(){var e=z.current;e&&e.updateFromShapeData(Object(l.a)(Object(l.a)({},e.shapeData),{},{color:o}))}),[o]),Object(a.useEffect)((function(){R.current.forEach((function(e){return e.isPlayMode=c})),L(),C(null)}),[c,C,L]);var B=Object(a.useCallback)((function(){k&&(E.current=Object(l.a)({},k))}),[k]),A=Object(a.useCallback)((function(){if(E.current){var e=Object(l.a)(Object(l.a)({},E.current),{},{id:Object(d.a)()});C(e.id),u([].concat(Object(f.a)(_.current),[e]))}}),[u,C]);b(B,A),Cn((function(){k&&X(k)}));var V=Object(a.useCallback)((function(e){var n,o=hn(e)?(n=e,{id:Object(d.a)(),type:n,track:{SoundPaletteKey:fn,soundPosition:[]},color:ln(),shapeScheme:{point:Object(l.a)({},sn),size:Object(l.a)({},dn)}}):function(e){for(var n=Object(l.a)({},sn),t=new v.a.Point(n),o=[],r=0;r<10;r++){var a=new v.a.Point({length:.5+.25*Math.random(),angle:36*r}),i=t.multiply(a),c=i.x,u=i.y,s=c+Math.floor(1.7*sn.x),f=u+Math.floor(1.7*sn.y);o.push({x:s,y:f})}return{id:Object(d.a)(),type:e,track:{SoundPaletteKey:fn,soundPosition:[]},color:ln(),shapeScheme:{points:o}}}(e);u([].concat(Object(f.a)(t),[o]))}),[t,u]),X=Object(a.useCallback)((function(e){var n=t.findIndex((function(n){return n.id===e.id}));-1!==n&&u([].concat(Object(f.a)(t.slice(0,n)),Object(f.a)(t.slice(n+1))))}),[t,u]),K=Object(a.useCallback)((function(e){k?D(Object(l.a)(Object(l.a)({},k),{},{color:e})):p(e)}),[k,p,D]),W=Object(a.useCallback)((function(e){k&&D(Object(l.a)(Object(l.a)({},k),{},{track:e}))}),[k,D]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(mn,{ref:S},i.a.createElement(yn,null,i.a.createElement(wn.a,{value:n,ref:H,placeholder:"Title",fullWidth:!0,onChange:function(e){return m(e.target.value)}})),i.a.createElement(un,{selectShape:k,isPlayMode:c,createFigure:V,removeFigure:X,openDownloadModal:y,openUploadModal:g,setPlayMode:O}),i.a.createElement(jn,{canvasRef:M}),!c&&i.a.createElement(le,{selectShape:k,background:o,onColorChange:K,onTrackChange:W})))},_n=t(191),kn=t(186),Sn=t(187),Mn=t(155),Rn=t(190),zn=t(192),Fn=t(195),Pn=t(183),Hn=t(76),Dn=t(77),Ln=function(e){var n=Object(Hn.b)(e);return Object(Dn.unpack)(n)},Bn=t(154),An=t(105);function Nn(){var e=Object($.a)(["\n  padding: 40px 10px;\n  background: #f5f5f5;\n  border: 1px "," #717171;\n  outline: none;\n  cursor: pointer;\n"]);return Nn=function(){return e},e}var Tn=ee.a.div(Nn(),(function(e){return e.isActive?"dashed":"solid"})),In=function(e){var n=e.onLoaded,t=e.accept,o=Object(a.useCallback)((function(e){var t,o=e[0];(t=o,new Promise((function(e){var n=new FileReader;n.addEventListener("loadend",(function(){return e(n.result)})),n.readAsArrayBuffer(t)}))).then((function(e){n(e)}))}),[n]),r=Object(An.a)({multiple:!1,onDrop:o,accept:null!==t&&void 0!==t?t:void 0}),c=r.getRootProps,u=r.getInputProps,l=r.isDragActive;return i.a.createElement(Tn,Object.assign({},c(),{isActive:l}),i.a.createElement("input",u()),l?i.a.createElement(Bn.a,null,"Drop the files here ..."):i.a.createElement(Bn.a,null,"Drag and drop the file, or click to select"))};function Un(){var e=Object($.a)(["\n  &.MuiButton-root {\n    background: #fff;\n    color: #2f2f2f;\n    border: 1px solid #2f2f2f;\n    box-shadow: none;\n    &:hover {\n      background: #fff;\n      box-shadow: none;\n    }\n  }\n"]);return Un=function(){return e},e}function Vn(){var e=Object($.a)(["\n  .MuiRadio-colorSecondary.Mui-checked {\n    color: #4e4e4e;\n  }\n"]);return Vn=function(){return e},e}function Xn(){var e=Object($.a)(["\n  width: 100%;\n  padding-bottom: 15px;\n"]);return Xn=function(){return e},e}function Kn(){var e=Object($.a)(["\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  position: absolute;\n  width: 500px;\n  height: 500px;\n  background-color: #fff;\n  padding: 15px;\n  outline: none;\n"]);return Kn=function(){return e},e}var Wn=ee.a.div(Kn()),Gn=Object(ee.a)(Fn.a)(Xn()),Zn=Object(ee.a)(Sn.a)(Vn()),Yn=Object(ee.a)(Pn.a)(Un()),Jn=function(e){var n=e.isOpen,t=e.uploadMusicPaper,o=e.closeUploadModal,r=Object(a.useState)("file"),c=Object(s.a)(r,2),u=c[0],l=c[1],d=Object(a.useState)(""),f=Object(s.a)(d,2),h=f[0],p=f[1],v=Object(a.useCallback)((function(e){var n=new TextDecoder("utf-8").decode(e),o=Ln(n);t(o)}),[t]),b=Object(a.useCallback)((function(){var e=Ln(h);t(e)}),[h,t]),m=Object(a.useCallback)((function(e){l(e)}),[l]);return i.a.createElement(_n.a,{open:n,onClose:o},i.a.createElement(Wn,null,i.a.createElement(X.a,{sx:{m:2}},i.a.createElement(kn.a,{component:"fieldset"},i.a.createElement(Mn.a,{component:"legend"}),i.a.createElement(zn.a,{name:"uploadType",value:u,row:!0,onChange:function(e,n){return m(n)}},i.a.createElement(Zn,{value:"file",control:i.a.createElement(Rn.a,null),label:"Upload the file"}),i.a.createElement(Zn,{value:"dataString",control:i.a.createElement(Rn.a,null),label:"Paste data from the clipboard"})))),"file"===u&&i.a.createElement("div",{style:{margin:"0 15px"}},i.a.createElement(In,{onLoaded:v,accept:".json"})),"dataString"===u&&i.a.createElement(i.a.Fragment,null,i.a.createElement(X.a,{sx:{m:2}},i.a.createElement(Gn,{label:"Paste data from the clipboard",multiline:!0,rows:7,placeholder:"Paste data from the clipboard",value:h,onChange:function(e){return p(e.target.value)}})),i.a.createElement("div",{style:{margin:"0 15px"}},i.a.createElement(Yn,{variant:"contained",fullWidth:!0,disabled:h.length<=0,onClick:b},"Upload")))))},qn=function(e,n){var t=document.createElement("a");t.download=n;var o=URL.createObjectURL(e);t.href=o,document.body.appendChild(t),t.click(),setTimeout((function(){document.body.removeChild(t),window.URL.revokeObjectURL(o)}),0)};function Qn(){var e=Object($.a)(["\n  &.MuiButton-root {\n    background: #fff;\n    color: #2f2f2f;\n    border: 1px solid #2f2f2f;\n    box-shadow: none;\n    &:hover {\n      background: #fff;\n      box-shadow: none;\n    }\n  }\n"]);return Qn=function(){return e},e}function $n(){var e=Object($.a)(["\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  position: absolute;\n  width: 500px;\n  height: auto;\n  background-color: #fff;\n  padding: 15px;\n  outline: none;\n"]);return $n=function(){return e},e}var et=ee.a.div($n()),nt=Object(ee.a)(Pn.a)(Qn()),tt=function(e){var n=e.isOpen,t=e.musicPaper,o=e.closeDownloadModal,r=Object(a.useMemo)((function(){return function(e){var n=Object(Dn.pack)(e);return Object(Hn.a)(n,!0)}(t)}),[t]),c=Object(a.useCallback)((function(){var e=new Blob([r],{type:"application/json"});qn(e,"".concat(t.title,".json"))}),[r,t]);return i.a.createElement(_n.a,{open:n,onClose:o},i.a.createElement(et,null,i.a.createElement(X.a,{sx:{mb:2}},i.a.createElement(Fn.a,{label:"Copy data to the clipboard or export as a file",multiline:!0,rows:16,value:r,fullWidth:!0})),i.a.createElement(nt,{variant:"contained",fullWidth:!0,disabled:r.length<=0,onClick:c},"Export")))},ot={alpha:1,green:255,red:255,blue:255},rt=function(){var e=Object(a.useState)(!1),n=Object(s.a)(e,2),t=n[0],o=n[1],r=Object(a.useState)(!1),c=Object(s.a)(r,2),u=c[0],f=c[1],h=Object(a.useState)(!1),p=Object(s.a)(h,2),v=p[0],b=p[1],m=Object(a.useState)({id:Object(d.a)(),title:"",version:"1.0.0",shapeList:[],backgroundColor:Object(l.a)({},ot)}),g=Object(s.a)(m,2),y=g[0],O=g[1];Object(a.useRef)(y).current=y;var x=Object(a.useCallback)((function(e){O(e),o(!1)}),[o,O]),j=Object(a.useCallback)((function(e){O((function(n){return Object(l.a)(Object(l.a)({},n),{},{shapeList:e})}))}),[O]),w=Object(a.useCallback)((function(e){O((function(n){return Object(l.a)(Object(l.a)({},n),{},{backgroundColor:e})}))}),[O]),C=Object(a.useCallback)((function(e){e.length>40||O((function(n){return Object(l.a)(Object(l.a)({},n),{},{title:e})}))}),[O]),E=Object(a.useCallback)((function(){o(!0)}),[o]),_=Object(a.useCallback)((function(){o(!1)}),[o]),k=Object(a.useCallback)((function(){f(!0)}),[f]),S=Object(a.useCallback)((function(){f(!1)}),[f]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(En,{title:y.title,shapeList:y.shapeList,backgroundColor:y.backgroundColor,isPlayMode:v,openUploadModal:E,openDownloadModal:k,updateShapeList:j,updateBackgroundColor:w,updateTitle:C,setPlayMode:b}),i.a.createElement(Jn,{isOpen:t,uploadMusicPaper:x,closeUploadModal:_}),i.a.createElement(tt,{isOpen:u,musicPaper:y,closeDownloadModal:S}))},at=(t(150),t(151),function(){return i.a.createElement(rt,null)}),it=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,196)).then((function(n){var t=n.getCLS,o=n.getFID,r=n.getFCP,a=n.getLCP,i=n.getTTFB;t(e),o(e),r(e),a(e),i(e)}))};u.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(at,null)),document.getElementById("root")),it()},25:function(e,n,t){"use strict";var o={default:{key:"default",caption:"Xylophone",matrix:[[{nodeName:"a7",sound:"x3",color:"#EF56CE"},{nodeName:"a8",sound:"x2",color:"#EC3899"},{nodeName:"a9",sound:"x1",color:"#E91A64"}],[{nodeName:"a4",sound:"x6",color:"#F489D0"},{nodeName:"a5",sound:"x5",color:"#F064A5"},{nodeName:"a6",sound:"x4",color:"#EE3E7B"}],[{nodeName:"a1",sound:"x9",color:"#F9BBD2"},{nodeName:"a2",sound:"x8",color:"#F38FB2"},{nodeName:"a3",sound:"x7",color:"#F16294"}]]},extra:{key:"extra",caption:"Bass",matrix:[[{nodeName:"b7",sound:"b3",color:"#4470E0"},{nodeName:"b8",sound:"b2",color:"#2356AF"},{nodeName:"b9",sound:"b1",color:"#013B7D"}],[{nodeName:"b4",sound:"b6",color:"#56A4E3"},{nodeName:"b5",sound:"b5",color:"#2B84BD"},{nodeName:"b6",sound:"b4",color:"#006396"}],[{nodeName:"b1",sound:"b9",color:"#67D8E5"},{nodeName:"b2",sound:"b8",color:"#43BCD4"},{nodeName:"b3",sound:"b7",color:"#0090B5"}]]},bass:{key:"bass",caption:"Drum",matrix:[[{nodeName:"d7",sound:"d3",color:"#44B7AC"},{nodeName:"d8",sound:"d2",color:"#22A992"},{nodeName:"d9",sound:"d1",color:"#009A78"}],[{nodeName:"d4",sound:"d6",color:"#6FC5AD"},{nodeName:"d5",sound:"d5",color:"#38BC94"},{nodeName:"d6",sound:"d4",color:"#00B27A"}],[{nodeName:"d1",sound:"d9",color:"#99D3AD"},{nodeName:"d2",sound:"d8",color:"#70D09E"},{nodeName:"d3",sound:"d7",color:"#46CC8F"}]]},Mixed:{key:"Mixed",caption:"Mixed",matrix:[[{nodeName:"x7",sound:"a3",color:"#aaa3b1"},{nodeName:"x8",sound:"a2",color:"#b94eb2"},{nodeName:"x9",sound:"a1",color:"#c617b2"}],[{nodeName:"x4",sound:"a6",color:"#d89e81"},{nodeName:"x5",sound:"a5",color:"#e15c7f"},{nodeName:"x6",sound:"a4",color:"#df2a89"}],[{nodeName:"x1",sound:"a9",color:"#f9ce04"},{nodeName:"x2",sound:"a8",color:"#f87f2e"},{nodeName:"x3",sound:"a7",color:"#f6434c"}]]}};n.a=o},57:function(e,n,t){"use strict";n.a={x1:"./sounds/1 Xylophone.mp3",x2:"./sounds/2 Xylophone.mp3",x3:"./sounds/3 Xylophone.mp3",x4:"./sounds/4 Xylophone.mp3",x5:"./sounds/5 Xylophone.mp3",x6:"./sounds/6 Xylophone.mp3",x7:"./sounds/7 Xylophone.mp3",x8:"./sounds/8 Xylophone.mp3",x9:"./sounds/9 Xylophone.mp3",b1:"./sounds/1 Bass.mp3",b2:"./sounds/2 Bass.mp3",b3:"./sounds/3 Bass.mp3",b4:"./sounds/4 Bass.mp3",b5:"./sounds/5 Bass.mp3",b6:"./sounds/6 Bass.mp3",b7:"./sounds/7 Bass.mp3",b8:"./sounds/8 Bass.mp3",b9:"./sounds/9 Bass.mp3",d1:"./sounds/1 Drums.mp3",d2:"./sounds/2 Drums.mp3",d3:"./sounds/3 Drums.mp3",d4:"./sounds/4 Drums.mp3",d5:"./sounds/5 Drums.mp3",d6:"./sounds/6 Drums.mp3",d7:"./sounds/7 Drums.mp3",d8:"./sounds/8 Drums.mp3",d9:"./sounds/9 Drums.mp3",a1:"./sounds/1.mp3",a2:"./sounds/2.mp3",a3:"./sounds/3.mp3",a4:"./sounds/4.mp3",a5:"./sounds/5.mp3",a6:"./sounds/6.mp3",a7:"./sounds/7.mp3",a8:"./sounds/8.mp3",a9:"./sounds/10.mp3"}},58:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var o=t(17),r=t(18),a=t(99);var i=function(){function e(n){var t=this;Object(o.a)(this,e),this.soundMap=void 0,this.soundMap={},Object.keys(n).forEach((function(e){var o=n[e];t.soundMap[e]=new a.Howl({src:[o]})}))}return Object(r.a)(e,[{key:"playSong",value:function(e){var n=this,t=e.find((function(e){return!n.soundMap[e]}));if(t)throw new Error("Unexpended sound ".concat(t));!function e(n,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=t[o];if(r){var a=n[r];a.once("end",(function(){e(n,t,o+1)})),a.play()}}(this.soundMap,e)}}]),e}()},93:function(e,n){},95:function(e,n,t){"use strict";var o=t(7),r=t(6),a=t(0),i=t.n(a),c=t(194),u=t(189),l=t(58),s=t(10),d=t(55),f=t(11);function h(){var e=Object(s.a)(["background: white"]);return h=function(){return e},e}function p(){var e=Object(s.a)(["\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    height: 100%;\n    width: 100%;\n    /* margin: 0 10px; */\n    box-sizing: border-box;\n    background-color: ",";\n    text-align: center;\n    cursor: pointer;\n    font-size: 12px;\n    ","\n    * {\n        font-size: 12px;\n    }\n"]);return p=function(){return e},e}function v(){var e=Object(s.a)(["\n    display: flex;\n    flex-direction: row;\n    width: 100%;\n    height: 100%;\n    /* margin: 10px 0; */\n"]);return v=function(){return e},e}function b(){var e=Object(s.a)(["\n    height: 100%;\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    margin-bottom: 10px;\n"]);return b=function(){return e},e}var m=f.a.div(b()),g=f.a.div(v()),y=f.a.div(p(),(function(e){var n;return null!==(n=e.color)&&void 0!==n?n:"#eee"}),(function(e){return e.isSelect&&Object(d.a)(h())})),O=function(e){var n=e.matrix,t=e.activeCell,o=e.schemeKey,r=e.onToggleCell,c=Object(a.useMemo)((function(){var e=new Array(n.length).fill(null).map((function(e,n){return[n,{}]})),o=Object.fromEntries(e);return t.reduce((function(e,n,t){var o=n.x;return e[n.y][o]=t+1,e}),o)}),[t,n]),u=Object(a.useCallback)((function(e,n){return!!c[n][e]}),[c]),l=Object(a.useCallback)((function(e,n){r({x:e,y:n})}),[r]);return i.a.createElement(m,null,n.map((function(e,n){return i.a.createElement(g,{key:"".concat(o,"-").concat(n)},e.map((function(e,t){return i.a.createElement(y,{key:"".concat(o,"-").concat(n,":").concat(t),isSelect:u(t,n),color:e.color,onClick:function(){return l(t,n)}},e.nodeName)})))})))},x=t(25),j=t(57);function w(){var e=Object(s.a)(["\n  width: 240px;\n  height: 240px;\n"]);return w=function(){return e},e}var C=f.a.div(w()),E=t(183);function _(){var e=Object(s.a)(["\n  &.MuiButton-root {\n    background: #fff;\n    color: #2f2f2f;\n    border: 1px solid #2f2f2f;\n    box-shadow: none;\n    &:hover {\n      background: #fff;\n      box-shadow: none;\n    }\n  }\n"]);return _=function(){return e},e}var k=Object(f.a)(E.a)(_()),S=t(154),M=Object.keys(x.a).map((function(e){return x.a[e]})),R=x.a.default,z=function(){return{SoundPaletteKey:R.key,soundPosition:[]}};n.a=function(e){var n,t=e.track,s=e.onTrackChange,d=Object(a.useState)((null===t||void 0===t?void 0:t.SoundPaletteKey)||R.key),f=Object(r.a)(d,2),h=f[0],p=f[1],v=Object(a.useMemo)((function(){return new l.a(j.a)}),[]),b=Object(a.useCallback)((function(){var e=t||z(),n=e.SoundPaletteKey,o=e.soundPosition,r=x.a[n].matrix,a=o.map((function(e){var n=e.x,t=e.y;return r[n][t].sound}));v.playSong(a)}),[v,t]),m=Object(a.useCallback)((function(e){var n,r=t||z(),a=r.SoundPaletteKey,i=r.soundPosition,c=i.findIndex((function(n){return o=e,(t=n).x===o.x&&t.y===o.y;var t,o}));n=-1!==c?[].concat(Object(o.a)(i.slice(0,c)),Object(o.a)(i.slice(c+1))):[].concat(Object(o.a)(i),[e]),s({SoundPaletteKey:a,soundPosition:n})}),[t,s]),g=Object(a.useCallback)((function(e){s({SoundPaletteKey:e,soundPosition:[]}),p(e)}),[p,s]);return i.a.createElement(C,null,i.a.createElement(u.a,{value:h,onChange:function(e){return g(e.target.value)},fullWidth:!0},M.map((function(e){var n=e.caption,t=e.key;return i.a.createElement(c.a,{key:t,value:t},n)}))),i.a.createElement(O,{matrix:x.a[h].matrix,activeCell:null!==(n=null===t||void 0===t?void 0:t.soundPosition)&&void 0!==n?n:[],schemeKey:h,onToggleCell:m}),i.a.createElement(k,{onClick:b,color:"primary",variant:"contained",fullWidth:!0},"Play sound"),i.a.createElement("p",null),i.a.createElement("p",null),i.a.createElement("p",null," "),i.a.createElement(S.a,null,"  Each pallette includes 9 sounds of different complexity: the lightest colour block (1) is for the single sound and the darkesr/brightest (9) is for the most complex sound in the palette."))}}},[[123,1,2]]]);
//# sourceMappingURL=main.19022905.chunk.js.map